Інструкція з оновлення проєкту у production-середовищі
Цей документ описує процес оновлення сайту з продажу годинників, що працює на WordPress. Включає етапи підготовки, оновлення та процедуру відкату у разі збою.
1. Підготовка до оновлення
1.1 Створення резервних копій
Виконати на сервері перед будь-яким оновленням!
 Бекап бази даних:
TIMESTAMP=$(date +%F-%H%M)
mysqldump -u watch_user -p watch_store_db > /var/backups/watch_store_db_$TIMESTAMP.sql
Бекап сайту:
tar -czvf /var/backups/watchstore_files_$TIMESTAMP.tar.gz /var/www/watchstore
Рекомендація: Зберігати щонайменше останні 3 резервні копії.
1.2 Перевірка сумісності
    • Перевірити changelog оновлення WordPress, плагінів або тем.
    • У разі оновлення PHP/Apache — перевірити сумісність версій з темами/плагінами (наприклад, Elementor Pro ≥ 3.20 для PHP 8.3).
    • Якщо є staging-сервер — протестувати оновлення там.
1.3 Планування часу простою (якщо потрібно)
    • Оновлення плагінів/тем: зазвичай не потребує зупинки сайту.
    • Оновлення ядра WordPress або зміна серверного ПЗ: рекомендовано робити вночі або у неробочий час.
    • Повідомити адміністратора сайту або клієнта (за потреби).
 2. Процес оновлення
2.1 Зупинка потрібних служб (якщо потрібна)

sudo systemctl stop apache2
Якщо оновлення не впливає на вебсервер (наприклад, лише плагіни) — зупиняти не обов’язково.
2.2 Розгортання нового коду
 Якщо використовується Git:
cd /var/www/watchstore
git pull origin main
 Якщо оновлення вручну (через FTP/SFTP):
    • Замінити файли теми/плагіна вручну
    • Очистити кеш (якщо є кешування)
2.3 Міграція даних (якщо потрібно)
При переході на нову структуру бази (рідко для WordPress)
    • Виконати SQL-міграцію вручну або через WP-CLI:
wp db query < update_script.sql
2.4 Оновлення конфігурацій
    • Оновити wp-config.php (якщо були зміни, наприклад, нові ключі безпеки, URL, константи).
    • Змінити apache2/sites-available/watchstore.conf, якщо оновлюється домен/SSL/шляхи.
    • Перезапустити Apache:
sudo systemctl restart apache2
4. Процедура відкату (rollback) у разі невдалого оновлення
Якщо після оновлення виникають помилки, виконайте наступні кроки:
4.1 Відновлення коду
tar -xzvf /var/backups/watchstore_files_<потрібна_дата>.tar.gz -C /
4.2 Відновлення бази даних
mysql -u watch_user -p watch_store_db < /var/backups/watch_store_db_<потрібна_дата>.sql
4.3 Очистка кешу та перезапуск серверу
sudo systemctl restart apache2
 Перевірте працездатність сайту за адресою https://watchstore.com
